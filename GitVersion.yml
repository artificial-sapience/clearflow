# GitVersion configuration for ClearFlow
# Optimized for Trunk-Based Development with Conventional Commits
# Using 0.x.y versioning during alpha phase

mode: ContinuousDeployment
next-version: 0.1.0  # Reset to 0.x.y after yanking 1.x releases (continuing from 0.0.6)

branches:
  main:
    regex: ^main$
    label: ''
    increment: Minor  # In 0.x.y, use Minor for features AND breaking changes
    is-main-branch: true
    prevent-increment:
      of-merged-branch: false

  feature:
    regex: ^(features?|feat)[/-]
    label: alpha
    increment: Inherit
    source-branches: ['main']

  pull-request:
    regex: ^(pull|pull\-requests|pr)[/-]
    label: pr
    increment: Inherit
    source-branches: ['main']

# Conventional Commits for 0.x.y alpha phase
# Breaking changes (!:) bump minor version, not major (while in 0.x)
major-version-bump-message: '^$'  # Disable major bumps during 0.x phase
minor-version-bump-message: '^(feat|fix|perf|refactor|revert)(\([\w\s-,/\\]*\))?(!:|:)'  # Any significant change bumps minor
patch-version-bump-message: '^(docs|style|test|ci|build)(\([\w\s-,/\\]*\))?:'  # Only minor changes bump patch
no-bump-message: '^chore(\(release\))?:'

# Use conventional commits for automatic versioning
commit-message-incrementing: Enabled

# Tag configuration
tag-prefix: 'v'